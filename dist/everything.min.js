var gameLogic;!function(a){function b(){return[["WLion","L","WTrap","WDen","WTrap","L","WTiger"],["L","WDog","L","WTrap","L","WCat","L"],["WMouse","L","WLeopard","L","WWolf","L","WElephant"],["L","R","R","L","R","R","L"],["L","R","R","L","R","R","L"],["L","R","R","L","R","R","L"],["BElephant","L","BWolf","L","BLeopard","L","BMouse"],["L","BCat","L","BTrap","L","BDog","L"],["BTiger","L","BTrap","BDen","BTrap","L","BLion"]]}function c(b,c){for(var e=d(c),f=0;f<a.ROWS;f++)for(var g=0;g<a.COLS;g++){var h=b[f][g],i={row:f,col:g};if(h[0]===e)switch(h.substring(1)){case"Mouse":if(N(b,c,i))return!1;break;case"Cat":if(L(b,c,i))return!1;break;case"Wolf":if(J(b,c,i))return!1;break;case"Dog":if(H(b,c,i))return!1;break;case"Leopard":if(F(b,c,i))return!1;break;case"Tiger":if(D(b,c,i))return!1;break;case"Lion":if(B(b,c,i))return!1;break;case"Elephant":if(z(b,c,i))return!1}}return!0}function d(a){return 0===a?"B":"W"}function e(a){switch(a){case"Mouse":return 0;case"Cat":return 1;case"Wolf":return 2;case"Dog":return 3;case"Leopard":return 4;case"Tiger":return 5;case"Lion":return 6;case"Elephant":return 7}}function f(b){return b.row<0||b.row>=a.ROWS||b.col<0||b.col>=a.COLS?!0:!1}function g(b,c){if(0===b){for(var d=0;d<a.BlackTraps.length;d++){var e=a.BlackTraps[d];if(angular.equals(e,c))return!0}return!1}if(1===b){for(var f=0;f<a.WhiteTraps.length;f++){var e=a.WhiteTraps[f];if(angular.equals(e,c))return!0}return!1}}function h(b){for(var c=0;c<a.RiverPos.length;c++){var d=a.RiverPos[c];if(angular.equals(d,b))return!0}return!1}function i(b){for(var c=0;c<a.BlackTraps.length;c++){var d=a.BlackTraps[c];if(angular.equals(d,b))return!0}return!1}function j(b){for(var c=0;c<a.WhiteTraps.length;c++){var d=a.WhiteTraps[c];if(angular.equals(d,b))return!0}return!1}function k(b){return angular.equals(a.BlackDen,b)?!0:!1}function l(b){return angular.equals(a.WhiteDen,b)?!0:!1}function m(b,c){return 0===b?angular.equals(c,a.BlackDen)?!0:!1:1===b?angular.equals(c,a.WhiteDen)?!0:!1:void 0}function n(a,b){var c=b.row,d=b.col;return"L"===a[c][d]||"R"===a[c][d]||"WTrap"===a[c][d]||"WDen"===a[c][d]||"BTrap"===a[c][d]||"BDen"===a[c][d]?!0:!1}function o(a,b,c){var d=c.row,e=c.col;return n(a,c)?!1:"B"===a[d][e].charAt(0)&&0===b?!0:"W"===a[d][e].charAt(0)&&1===b?!0:!1}function p(b){return"BDen"!==b[a.BlackDen.row][a.BlackDen.col]?"W":"WDen"!==b[a.WhiteDen.row][a.WhiteDen.col]?"B":""}function q(a,b,c){var d=[],e={row:c.row-1,col:c.col},f={row:c.row+1,col:c.col},g={row:c.row,col:c.col-1},h={row:c.row,col:c.col+1};return r(a,b,c,e)&&d.push(e),r(a,b,c,f)&&d.push(f),r(a,b,c,g)&&d.push(g),r(a,b,c,h)&&d.push(h),d}function r(a,b,c,d){if(f(d)||h(d)||m(b,d))return!1;if(c.row!==d.row&&c.col!==d.col)return!1;if(c.row===d.row){if(1!==Math.abs(c.col-d.col))return!1}else if(c.col===d.col){if(1!==Math.abs(c.row-d.row))return!1}else if(angular.equals(c,d))return!1;return x(a,b,c,d)}function s(a,b,c){if(b.row===c.row){var d,e;return b.col<c.col?(d=a[b.row][b.col+1],e=a[b.row][b.col+2]):(d=a[b.row][b.col-1],e=a[b.row][b.col-2]),"Mouse"===d.substring(1)||"Mouse"===e.substring(1)?!0:!1}var d,e,f;return b.row<c.row?(d=a[b.row+1][b.col],e=a[b.row+2][b.col],f=a[b.row+3][b.col]):(d=a[b.row-1][b.col],e=a[b.row-2][b.col],f=a[b.row-3][b.col]),"Mouse"===d.substring(1)||"Mouse"===e.substring(1)||"Mouse"===f.substring(1)?!0:!1}function t(a,b,c){var d=[],e={row:c.row-1,col:c.col};h(e)?s(a,c,e)||(e.row=e.row-3,u(a,b,c,e)&&d.push(e)):u(a,b,c,e)&&d.push(e);var f={row:c.row+1,col:c.col};h(f)?s(a,c,f)||(f.row=f.row+3,u(a,b,c,f)&&d.push(f)):u(a,b,c,f)&&d.push(f);var g={row:c.row,col:c.col-1};h(g)?s(a,c,g)||(g.col=g.col-2,u(a,b,c,g)&&d.push(g)):u(a,b,c,g)&&d.push(g);var i={row:c.row,col:c.col+1};return h(i)?s(a,c,i)||(i.col=i.col+2,u(a,b,c,i)&&d.push(i)):u(a,b,c,i)&&d.push(i),d}function u(a,b,c,d){if(f(d)||h(d)||m(b,d))return!1;if(c.row!==d.row&&c.col!==d.col)return!1;if(c.row===d.row){if(1!==Math.abs(c.col-d.col)&&3!==Math.abs(c.col-d.col))return!1}else if(c.col===d.col){if(1!==Math.abs(c.row-d.row)&&4!==Math.abs(c.row-d.row))return!1}else if(angular.equals(c,d))return!1;if(c.row===d.row){var e;return c.col<d.col?(e={row:c.row,col:c.col+1},h(e)?d.col-c.col===1?!1:s(a,c,d)?!1:x(a,b,c,d):d.col-c.col===3?!1:x(a,b,c,d)):(e={row:c.row,col:c.col-1},h(e)?c.col-d.col===1?!1:s(a,c,d)?!1:x(a,b,c,d):c.col-d.col===3?!1:x(a,b,c,d))}var e;return c.row<d.row?(e={row:c.row+1,col:c.col},h(e)?d.col-c.col===1?!1:s(a,c,d)?!1:x(a,b,c,d):d.col-c.col===4?!1:x(a,b,c,d)):(e={row:c.row-1,col:c.col},h(e)?c.col-d.col===1?!1:s(a,c,d)?!1:x(a,b,c,d):c.col-d.col===4?!1:x(a,b,c,d))}function v(a,b,c){var d=[],e={row:c.row-1,col:c.col},f={row:c.row+1,col:c.col},g={row:c.row,col:c.col-1},h={row:c.row,col:c.col+1};return w(a,b,c,e)&&d.push(e),w(a,b,c,f)&&d.push(f),w(a,b,c,g)&&d.push(g),w(a,b,c,h)&&d.push(h),d}function w(a,b,c,d){if(f(d)||m(b,d))return!1;if(c.row!==d.row&&c.col!==d.col)return!1;if(c.row===d.row){if(1!==Math.abs(c.col-d.col))return!1}else if(c.col===d.col){if(1!==Math.abs(c.row-d.row))return!1}else if(angular.equals(c,d))return!1;return x(a,b,c,d)}function x(a,b,c,d){if(n(a,d))return!0;if(o(a,b,d))return!1;var f=a[c.row][c.col],i=a[d.row][d.col],j=e(f.substring(1)),k=e(i.substring(1));return g(b,d)?!0:j>=k?7===j&&0===k?!1:!0:0===j&&7===k?h(c)?!1:!0:!1}function y(a,b,c){var d=q(a,b,c);return d}function z(a,b,c){return 0!==y(a,b,c).length}function A(a,b,c){var d=t(a,b,c);return d}function B(a,b,c){return 0!==A(a,b,c).length}function C(a,b,c){var d=t(a,b,c);return d}function D(a,b,c){return 0!==C(a,b,c).length}function E(a,b,c){var d=q(a,b,c);return d}function F(a,b,c){return 0!==E(a,b,c).length}function G(a,b,c){var d=q(a,b,c);return d}function H(a,b,c){return 0!==G(a,b,c).length}function I(a,b,c){var d=q(a,b,c);return d}function J(a,b,c){return 0!==I(a,b,c).length}function K(a,b,c){var d=q(a,b,c);return d}function L(a,b,c){return 0!==K(a,b,c).length}function M(a,b,c){var d=v(a,b,c);return d}function N(a,b,c){return 0!==M(a,b,c).length}function O(a,e,f,g){a||(a=b());var m=a[f.row][f.col],n=a[g.row][g.col],o=d(e);if(f.row===g.row&&f.col===g.col)throw new Error("Cannot move to same position.");if("Den"===n.substring(1)&&n[0]===o)throw new Error("Cannot move into you own Den");if(m.charAt(0)!==o)throw new Error("R"===m||"L"===m?"There is no piece to move":"Cannot move opponent's piece");if("Den"===m.substring(1)||"Trap"===m.substring(1))throw new Error("There is no piece to move");if(""!==p(a)||c(a,e))throw new Error("Cannot make a move if the game is over!");if("L"!==n&&"R"!==n&&"Trap"!==n.substring(1)&&"Den"!==n.substring(1)&&o===n.charAt(0))throw new Error("One can only make a move in an empty position or capture opponent's piece!");var q=angular.copy(a),s=m.substring(1);switch(s){case"Elephant":if(!r(a,e,f,g))throw new Error("Illegal move for Elephant.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Lion":if(!u(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Tiger":if(!u(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Leopard":if(!r(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Dog":if(!r(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Wolf":if(!r(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Cat":if(!r(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;case"Mouse":if(!w(a,e,f,g))throw new Error("Illegal move for Lion.");q[f.row][f.col]=h(f)?"R":i(f)?"BTrap":j(f)?"WTrap":k(f)?"BDen":l(f)?"WDen":"L",q[g.row][g.col]=m;break;default:throw new Error("Unknown piece type!")}var t,v=p(q);return t=""!==v||c(q,1-e)?{endMatch:{endMatchScores:"B"===v?[1,0]:"W"===v?[0,1]:[0,0]}}:{setTurn:{turnIndex:1-e}},[t,{set:{key:"board",value:q}},{set:{key:"deltaFrom",value:{row:f.row,col:f.col}}},{set:{key:"deltaTo",value:{row:g.row,col:g.col}}}]}function P(a){var b=a.move,c=a.turnIndexBeforeMove,d=a.stateBeforeMove;try{var e=b[2].set.value,f=b[3].set.value,g=d.board,h=O(g,c,e,f);if(!angular.equals(b,h))return!1}catch(i){return!1}return!0}a.ROWS=9,a.COLS=7,a.BlackTraps=[{row:8,col:2},{row:7,col:3},{row:8,col:4}],a.WhiteTraps=[{row:0,col:2},{row:1,col:3},{row:0,col:4}],a.RiverPos=[{row:3,col:1},{row:3,col:2},{row:3,col:4},{row:3,col:5},{row:4,col:1},{row:4,col:2},{row:4,col:4},{row:4,col:5},{row:5,col:1},{row:5,col:2},{row:5,col:4},{row:5,col:5}],a.BlackDen={row:8,col:3},a.WhiteDen={row:0,col:3},a.getInitialBoard=b,a.getTurn=d,a.getElephantPossibleMoves=y,a.canElephantMoveAnywhere=z,a.getLionPossibleMoves=A,a.canLionMoveAnywhere=B,a.getTigerPossibleMoves=C,a.canTigerMoveAnywhere=D,a.getLeopardPossibleMoves=E,a.canLeopardMoveAnywhere=F,a.getDogPossibleMoves=G,a.canDogMoveAnywhere=H,a.getWolfPossibleMoves=I,a.canWolfMoveAnywhere=J,a.getCatPossibleMoves=K,a.canCatMoveAnywhere=L,a.getMousePossibleMoves=M,a.canMouseMoveAnywhere=N,a.createMove=O,a.isMoveOk=P}(gameLogic||(gameLogic={}));var game;!function(a){function b(){console.log("Translation of 'RULES_OF_TICTACTOE' is "+translate("RULES_OF_TICTACTOE")),resizeGameAreaService.setWidthToHeight(1),gameService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,isMoveOk:gameLogic.isMoveOk,updateUI:e}),document.addEventListener("animationend",c,!1),document.addEventListener("webkitAnimationEnd",c,!1),document.addEventListener("oanimationend",c,!1)}function c(){$rootScope.$apply(function(){log.info("Animation ended"),k=!0,m&&d()})}function d(){gameService.makeMove(aiService.createComputerMove(n.board,o,{millisecondsLimit:1e3}))}function e(a){k=!1,n=a.stateAfterMove,n.board||(n.board=gameLogic.getInitialBoard()),l=a.turnIndexAfterMove>=0&&a.yourPlayerIndex===a.turnIndexAfterMove,o=a.turnIndexAfterMove,m=l&&""===a.playersInfo[a.yourPlayerIndex].playerId,m&&(l=!1,n.delta||d())}function f(a,b){if(log.info(["Clicked on cell:",a,b]),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(l)try{var c=gameLogic.createMove(n.board,a,b,o);l=!1,gameService.makeMove(c)}catch(d){return void log.info(["Cell is already full in position:",a,b])}}function g(a,b){var c=n.board[a][b];return""!==c}function h(a,b){return"X"===n.board[a][b]}function i(a,b){return"O"===n.board[a][b]}function j(a,b){return!k&&n.delta&&n.delta.row===a&&n.delta.col===b}var k=!1,l=!1,m=!1,n=null,o=null;a.isHelpModalShown=!1,a.init=b,a.cellClicked=f,a.shouldShowImage=g,a.isPieceX=h,a.isPieceO=i,a.shouldSlowlyAppear=j}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap"]).run(["initGameServices",function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_TICTACTOE:"Rules of TicTacToe",RULES_SLIDE1:"You and your opponent take turns to mark the grid in an empty spot. The first mark is X, then O, then X, then O, etc.",RULES_SLIDE2:"The first to mark a whole row, column or diagonal wins.",CLOSE:"Close"}),game.init()}]);var aiService;!function(a){function b(a,b){var c=[];if(!a)return[];for(var d=gameLogic.getTurn(b),e=0;e<gameLogic.ROWS;e++)for(var f=0;f<gameLogic.COLS;f++){var g=a[e][f];if("L"!==g&&"R"!==g&&g.charAt(0)===d){var h,i={row:e,col:f};switch(g.substring(1)){case"Elephant":if(h=gameLogic.getElephantPossibleMoves(a,b,i),h.length>0)for(var j=0;j<h.length;j++){var k=h[j];c.push(gameLogic.createMove(a,b,i,k))}break;case"Lion":if(h=gameLogic.getLionPossibleMoves(a,b,i),h.length>0)for(var l=0;l<h.length;l++){var k=h[l];c.push(gameLogic.createMove(a,b,i,k))}break;case"Tiger":if(h=gameLogic.getTigerPossibleMoves(a,b,i),h.length>0)for(var m=0;m<h.length;m++){var k=h[m];c.push(gameLogic.createMove(a,b,i,k))}break;case"Leopard":if(h=gameLogic.getLeopardPossibleMoves(a,b,i),h.length>0)for(var n=0;n<h.length;n++){var k=h[n];c.push(gameLogic.createMove(a,b,i,k))}break;case"Dog":if(h=gameLogic.getDogPossibleMoves(a,b,i),h.length>0)for(var o=0;o<h.length;o++){var k=h[o];c.push(gameLogic.createMove(a,b,i,k))}break;case"Wolf":if(h=gameLogic.getWolfPossibleMoves(a,b,i),h.length>0)for(var p=0;p<h.length;p++){var k=h[p];c.push(gameLogic.createMove(a,b,i,k))}break;case"Cat":if(h=gameLogic.getCatPossibleMoves(a,b,i),h.length>0)for(var q=0;q<h.length;q++){var k=h[q];c.push(gameLogic.createMove(a,b,i,k))}break;case"Mouse":if(h=gameLogic.getMousePossibleMoves(a,b,i),h.length>0)for(var r=0;r<h.length;r++){var k=h[r];c.push(gameLogic.createMove(a,b,i,k))}}}}return c}function c(a,b,c){return alphaBetaService.alphaBetaDecision([null,{set:{key:"board",value:a}}],b,e,d,"?debug"===window.location.search?f:null,c)}function d(a){if(a[0].endMatch){var b=a[0].endMatch.endMatchScores;return b[0]>b[1]?Number.POSITIVE_INFINITY:b[0]<b[1]?Number.NEGATIVE_INFINITY:0}return 0}function e(a,c){return b(a[1].set.value,c)}function f(a){return"\n"+a[1].set.value.join("\n")+"\n"}a.getPossibleMoves=b,a.createComputerMove=c}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map